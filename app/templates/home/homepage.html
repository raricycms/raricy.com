{% extends "base.html" %}

{% block title %}Raricy.com - 聪明山 - 首页{% endblock %}

{% block extra_css %}
<meta name="google-site-verification" content="LRVbLEdJxTTwwbT114ygONe1auaak1IJxv1Eyr-vZt8" />
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section" id="home">
    <canvas id="hero-canvas"></canvas>
    <div class="home-container">
        <div class="home-row home-text-center">
            <div class="home-col-6">
                <div class="text-white fade-in-up hero-content">
                    <h1 class="home-display" style="color:#fff; margin-bottom:1rem;">聪明山</h1>
                    <p class="home-lead" style="color:#fff; opacity:0.9; margin-bottom:1rem; font-style: italic; font-size:1.5rem;">我 们 总 将 找 到 答 案</p>
                    <p style="color:#fff; opacity:0.9; margin-bottom:1rem; font-size:1.125rem;">欢迎访问聪明山 website。这里是 Raricy.com 的主页面，你可以由此进入 Raricy.com 的大部分页面</p>
                </div>
            </div>
            
        </div>
    </div>
    </section>
<section class="features-section" id="features">
    <div class="home-container">
        <div class="home-row" style="margin-bottom: 2rem;">
            <div class="home-col-12 home-text-center">
                <h2 class="home-display">探索</h2>
                <p class="home-lead u-text-muted">以下是此网站的核心内容。</p>
            </div>
        </div>

        <div class="home-grid">
            <div class="home-grid-item">
                <div class="feature-card card-story" data-url="{{url_for('story.menu')}}" onclick="handleCardClick(this)">
                    <div class="card-body home-text-center">
                        <span class="feature-icon" aria-hidden="true"></span>
                        <h4 class="card-title" style="margin-bottom: 0.75rem;">故事/小说</h4>
                        <p class="card-text">聪明山故事集，这里有一些聪明山的原创故事和小说，也有代发的原创小说。</p>
                        <a href="{{ url_for('story.menu') }}" class="home-btn home-btn--outline-primary home-btn--sm">开始阅读</a>
                    </div>
                </div>
            </div>

            <div class="home-grid-item">
                <div class="feature-card card-game">
                    <div class="card-body home-text-center">
                        <span class="feature-icon" aria-hidden="true"></span>
                        <h4 class="card-title" style="margin-bottom: 0.75rem;">玩具（维护中）</h4>
                        <p class="card-text">该功能正在维护中，暂不可用。</p>
                        <button class="home-btn home-btn--outline-secondary home-btn--sm" disabled aria-disabled="true">维护中</button>
                    </div>
                </div>
            </div>

            <div class="home-grid-item">
                <div class="feature-card card-blog" data-url="{{url_for('blog.menu')}}" onclick="handleCardClick(this)">
                    <div class="card-body home-text-center">
                        <span class="feature-icon" aria-hidden="true"></span>
                        <h4 class="card-title" style="margin-bottom: 0.75rem;">博客/文章</h4>
                        <p class="card-text">这里有一些博客文章和思考分享，涵盖技术、生活、思考等多个方面。</p>
                        <a href="{{ url_for('blog.menu') }}" class="home-btn home-btn--outline-warning home-btn--sm">阅读文章</a>
                    </div>
                </div>
            </div>

            <div class="home-grid-item">
                <div class="feature-card card-tool" data-url="{{url_for('tool.menu')}}" onclick="handleCardClick(this)">
                    <div class="card-body home-text-center">
                        <span class="feature-icon" aria-hidden="true"></span>
                        <h4 class="card-title" style="margin-bottom: 0.75rem;">工具</h4>
                        <p class="card-text">常用小工具合集：Base 编码、Hex 查看等，助你更高效。</p>
                        <a href="{{ url_for('tool.menu') }}" class="home-btn home-btn--outline-info home-btn--sm">打开工具箱</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block footer_text %}
<p class="u-text-muted">你是否正在找智慧河的网站？来<a href="https://zhh.raricy.com">这里</a>。</p>
{% endblock %}

{% block extra_js %}
<script>
    console.log('hello!')
    console.log('https://raricy.com/zhh')
    // 卡片点击跳转处理函数
    function handleCardClick(element) {
        const url = element.getAttribute('data-url');
        if (url) {
            window.location.href = url;
        }
    }

    // Interactive Canvas Background
    const canvas = document.getElementById('hero-canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    let mouse = { x: null, y: null };

    // Debounce function to limit how often a function gets called.
    function debounce(func, wait = 250) {
        let timeout;
        return function(...args) {
            const context = this;
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(context, args), wait);
        };
    }

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = document.querySelector('.hero-section').offsetHeight;
        // Re-initialize particles on resize to fit new dimensions
        init();
    }
    window.addEventListener('mousemove', (e) => {
        const rect = canvas.getBoundingClientRect();
        mouse.x = e.clientX - rect.left;
        mouse.y = e.clientY - rect.top;
    });
    window.addEventListener('mouseout', () => {
        mouse.x = null;
        mouse.y = null;
    });

    class Particle {
        constructor(x, y, dx, dy, radius, color) {
            this.x = x; this.y = y; this.dx = dx; this.dy = dy;
            this.radius = radius; this.color = color;
        }
        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);
            ctx.fillStyle = this.color;
            ctx.fill();
        }
        update() {
            if (this.x + this.radius > canvas.width || this.x - this.radius < 0) this.dx = -this.dx;
            if (this.y + this.radius > canvas.height || this.y - this.radius < 0) this.dy = -this.dy;
            this.x += this.dx; this.y += this.dy;
            this.draw();
        }
    }

    function init() {
        particles = [];
        for (let i = 0; i < 80; i++) {
            let radius = Math.random() * 2 + 1;
            let x = Math.random() * (canvas.width - radius * 2) + radius;
            let y = Math.random() * (canvas.height - radius * 2) + radius;
            let dx = (Math.random() - 0.5) * 0.5;
            let dy = (Math.random() - 0.5) * 0.5;
            particles.push(new Particle(x, y, dx, dy, radius, 'rgba(255, 255, 255, 0.5)'));
        }
    }

    let animationFrameId = null;
    function animate() {
        animationFrameId = requestAnimationFrame(animate);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => p.update());
    }

    function handleVisibilityChange() {
        if (document.hidden) {
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
                animationFrameId = null;
            }
        } else {
            if (!animationFrameId) {
                animate();
            }
        }
    }

    // Initial setup and event listeners
    resizeCanvas(); // This will set size and call init()
    animate();
    window.addEventListener('resize', debounce(resizeCanvas));
    document.addEventListener('visibilitychange', handleVisibilityChange);
</script>
{% endblock %}