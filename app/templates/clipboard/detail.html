{% extends "base.html" %}
{% block title %}
{{clip['title']}} - Raricy.com 云剪贴板
{% endblock %}

{% block extra_css %}
{% endblock %}

{% block content %}
<div class="clipboard-page">
    <div class="clipboard-detail">
        <div class="clipboard-detail__header">
            <h1 class="clipboard-detail__header-title">{{clip['title']}}</h1>
            <div class="clipboard-detail__header-meta">
                <span>作者：{{clip.author_name}}</span>
                <span>ID：{{clip.id}}</span>
            </div>
        </div>
        
        <div class="clipboard-detail__content">
            <pre>{{clip['content']}}</pre>
        </div>
        
        <div class="clipboard-detail__actions">
            {% if clip['author_id'] == current_user.id %}
            <button class="action-button primary" onclick="window.open(`${window.location.pathname}/edit`)">编辑文章</button>
            {% endif %}
            {% if clip['author_id'] == current_user.id or current_user.is_owner %}
            <button class="action-button danger" id="delete">删除文章</button>
            {% endif %}
            <a href="/clipboard/" class="action-button">返回云剪贴板主页</a>
            <button class="action-button" onclick="history.back()">返回上页</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('delete').addEventListener('click', () => {
           delete_clipboard() 
        });
    });
    function delete_clipboard(){
        if(!confirm('确认要删除吗？')) return;
        fetch(window.location.pathname, {
            method: 'DELETE'
        })
            .then(response => {
                if (response.ok) {
                    alert('删除成功！');
                    window.location.href = '/clipboard/'
                }
            })
            .catch(error => {
                alert("删除失败qaq");
                console.error("删除失败:", error);
            })
    }
</script>
{% endblock %}

{% block copyright %}
原作者：{{clip['author_name']}} | 版权归原作者所有
{% endblock %}
