{% extends "base.html" %}

{% block title %}åšå®¢ç®¡ç†åå° - æ§åˆ¶é¢æ¿{% endblock %}

{% block extra_css %}
<style>
    .admin-hero {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        padding: 50px 0 30px;
        text-align: center;
        color: white;
    }

    .admin-container {
        max-width: 1400px;
        margin: 40px auto;
        padding: 0 20px;
    }

    .dashboard-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 24px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        border: 1px solid #e5e7eb;
        transition: all 0.3s ease;
    }

    .dashboard-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        border-left: 4px solid;
        text-align: center;
        transition: all 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }

    .stat-card.total { border-left-color: #3b82f6; }
    .stat-card.categorized { border-left-color: #10b981; }
    .stat-card.uncategorized { border-left-color: #f59e0b; }
    .stat-card.categories { border-left-color: #8b5cf6; }
    .stat-card.likes { border-left-color: #ef4444; }

    .stat-number {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 8px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .stat-label {
        font-size: 0.95rem;
        color: #6b7280;
        font-weight: 500;
    }

    .function-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 24px;
        margin-bottom: 30px;
    }

    .function-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        border: 1px solid #e5e7eb;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .function-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
    }

    .function-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }

    .function-icon {
        font-size: 2.5rem;
        margin-bottom: 16px;
        display: block;
    }

    .function-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 12px;
    }

    .function-desc {
        color: #6b7280;
        margin-bottom: 20px;
        line-height: 1.6;
    }

    .function-actions {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
    }

    .btn-function {
        padding: 8px 16px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 500;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        border: 1px solid;
        display: inline-flex;
        align-items: center;
        gap: 6px;
    }

    .btn-primary-function {
        background: #3b82f6;
        color: white;
        border-color: #3b82f6;
    }

    .btn-primary-function:hover {
        background: #2563eb;
        border-color: #2563eb;
        color: white;
        text-decoration: none;
        transform: translateY(-1px);
    }

    .btn-secondary-function {
        background: white;
        color: #6b7280;
        border-color: #d1d5db;
    }

    .btn-secondary-function:hover {
        background: #f9fafb;
        color: #374151;
        border-color: #9ca3af;
        text-decoration: none;
        transform: translateY(-1px);
    }

    .recent-list {
        max-height: 300px;
        overflow-y: auto;
    }

    .recent-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #f3f4f6;
    }

    .recent-item:last-child {
        border-bottom: none;
    }

    .recent-title {
        font-weight: 500;
        color: #1f2937;
        margin-bottom: 4px;
    }

    .recent-meta {
        font-size: 0.85rem;
        color: #6b7280;
    }

    .category-chart {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 16px;
    }

    .category-item {
        text-align: center;
        padding: 16px;
        background: #f9fafb;
        border-radius: 8px;
        border: 1px solid #e5e7eb;
    }

    .category-icon {
        font-size: 1.5rem;
        margin-bottom: 8px;
    }

    .category-name {
        font-size: 0.9rem;
        font-weight: 500;
        color: #374151;
        margin-bottom: 4px;
    }

    .category-count {
        font-size: 1.2rem;
        font-weight: 600;
        color: #3b82f6;
    }

    @media (max-width: 768px) {
        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .function-grid {
            grid-template-columns: 1fr;
        }

        .function-actions {
            justify-content: center;
        }

        .category-chart {
            grid-template-columns: repeat(2, 1fr);
        }
    }
</style>
{% endblock %}

{% block content %}
<section class="admin-hero">
    <h1>ğŸ› ï¸ åšå®¢ç®¡ç†åå°</h1>
    <p>ç®¡ç†å‘˜æ§åˆ¶é¢æ¿ - ç»Ÿä¸€ç®¡ç†åšå®¢å†…å®¹ä¸æ ç›®</p>
</section>

<div class="admin-container">
    <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
    <div class="stats-grid">
        <div class="stat-card total">
            <div class="stat-number">{{ stats.total_blogs }}</div>
            <div class="stat-label">ğŸ“„ æ€»æ–‡ç« æ•°</div>
        </div>
        <div class="stat-card categorized">
            <div class="stat-number">{{ stats.categorized_blogs }}</div>
            <div class="stat-label">ğŸ“ å·²åˆ†ç±»æ–‡ç« </div>
        </div>
        <div class="stat-card uncategorized">
            <div class="stat-number">{{ stats.uncategorized_blogs }}</div>
            <div class="stat-label">ğŸ“‹ æœªåˆ†ç±»æ–‡ç« </div>
        </div>
        <div class="stat-card categories">
            <div class="stat-number">{{ stats.total_categories }}</div>
            <div class="stat-label">ğŸ·ï¸ æ´»è·ƒæ ç›®</div>
        </div>
        <div class="stat-card likes">
            <div class="stat-number">{{ stats.total_likes }}</div>
            <div class="stat-label">â¤ï¸ æ€»ç‚¹èµæ•°</div>
        </div>
    </div>

    <!-- ç®¡ç†åŠŸèƒ½ -->
    <div class="function-grid">
        <!-- æ–‡ç« ç®¡ç† -->
        <div class="function-card">
            <div class="function-icon">ğŸ“</div>
            <div class="function-title">æ–‡ç« ç®¡ç†</div>
            <div class="function-desc">
                æŸ¥çœ‹ã€æœç´¢ã€ç¼–è¾‘å’Œåˆ é™¤åšå®¢æ–‡ç« ï¼Œç®¡ç†æ–‡ç« çš„æ ç›®åˆ†é…ï¼Œæ‰¹é‡æ“ä½œæ–‡ç« ã€‚
            </div>
            <div class="function-actions">
                <a href="/blog/admin/articles" class="btn-function btn-primary-function">
                    ğŸ“‚ æ–‡ç« æ ç›®ç®¡ç†
                </a>
                <a href="/blog/" class="btn-function btn-secondary-function">
                    ğŸ‘ï¸ æŸ¥çœ‹åšå®¢
                </a>
            </div>
        </div>

        <!-- æ ç›®ç®¡ç† -->
        <div class="function-card">
            <div class="function-icon">ğŸ·ï¸</div>
            <div class="function-title">æ ç›®ç®¡ç†</div>
            <div class="function-desc">
                åˆ›å»ºã€ç¼–è¾‘å’Œåˆ é™¤åšå®¢æ ç›®ï¼Œç®¡ç†æ ç›®å±‚çº§ç»“æ„ï¼Œè®¾ç½®æ ç›®å›¾æ ‡å’Œæè¿°ã€‚
            </div>
            <div class="function-actions">
                <a href="/blog/admin/categories" class="btn-function btn-primary-function">
                    ğŸ› ï¸ æ ç›®ç®¡ç†
                </a>
                <a href="/blog/?category=academic" class="btn-function btn-secondary-function">
                    ğŸ‘€ é¢„è§ˆæ ç›®
                </a>
            </div>
        </div>

        <!-- å†…å®¹åˆ›ä½œ -->
        <div class="function-card">
            <div class="function-icon">âœï¸</div>
            <div class="function-title">å†…å®¹åˆ›ä½œ</div>
            <div class="function-desc">
                å‘å¸ƒæ–°æ–‡ç« ï¼Œä½¿ç”¨Markdownç¼–è¾‘å™¨åˆ›ä½œå†…å®¹ï¼Œè®¾ç½®æ–‡ç« æ ç›®å’Œæè¿°ã€‚
            </div>
            <div class="function-actions">
                <a href="/blog/upload_blog" class="btn-function btn-primary-function">
                    â• å‘å¸ƒæ–‡ç« 
                </a>
                <a href="https://commonmark.org/help/" target="_blank" class="btn-function btn-secondary-function">
                    ğŸ“– MarkdownæŒ‡å—
                </a>
            </div>
        </div>

        <!-- ç”¨æˆ·äº’åŠ¨ -->
        <div class="function-card">
            <div class="function-icon">ğŸ’¬</div>
            <div class="function-title">ç”¨æˆ·äº’åŠ¨</div>
            <div class="function-desc">
                æŸ¥çœ‹æ–‡ç« ç‚¹èµæƒ…å†µï¼Œç®¡ç†ç”¨æˆ·äº’åŠ¨æ•°æ®ï¼Œåˆ†æçƒ­é—¨å†…å®¹ã€‚
            </div>
            <div class="function-actions">
                <a href="/blog/" class="btn-function btn-primary-function">
                    ğŸ“Š æŸ¥çœ‹çƒ­é—¨
                </a>
                <a href="/blog/admin/articles?category_id=-1" class="btn-function btn-secondary-function">
                    ğŸ” æœªåˆ†ç±»æ–‡ç« 
                </a>
            </div>
        </div>
    </div>

    <!-- æ•°æ®æ¦‚è§ˆ -->
    <div class="row">
        <!-- æœ€è¿‘æ–‡ç«  -->
        <div class="col-md-6">
            <div class="dashboard-card">
                <h5 class="mb-3">ğŸ“… æœ€è¿‘æ–‡ç« </h5>
                <div class="recent-list">
                    {% for blog in stats.recent_blogs %}
                    <div class="recent-item">
                        <div>
                            <div class="recent-title">{{ blog.title }}</div>
                            <div class="recent-meta">
                                ğŸ‘¤ {{ blog.author }} â€¢ ğŸ“… {{ blog.date }} â€¢ â¤ï¸ {{ blog.likes_count or 0 }}
                                {% if blog.category %}
                                â€¢ ğŸ“ {{ blog.category }}
                                {% endif %}
                            </div>
                        </div>
                        <div>
                            <a href="/blog/{{ blog.id }}" class="btn btn-sm btn-outline-primary" target="_blank">æŸ¥çœ‹</a>
                        </div>
                    </div>
                    {% endfor %}
                    
                    {% if not stats.recent_blogs %}
                    <div class="text-center py-3 text-muted">
                        æš‚æ— æ–‡ç« 
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- çƒ­é—¨æ–‡ç«  -->
        <div class="col-md-6">
            <div class="dashboard-card">
                <h5 class="mb-3">ğŸ”¥ çƒ­é—¨æ–‡ç« </h5>
                <div class="recent-list">
                    {% for blog in stats.popular_blogs %}
                    <div class="recent-item">
                        <div>
                            <div class="recent-title">{{ blog.title }}</div>
                            <div class="recent-meta">
                                ğŸ‘¤ {{ blog.author }} â€¢ â¤ï¸ {{ blog.likes_count or 0 }} 
                                {% if blog.category %}
                                â€¢ ğŸ“ {{ blog.category }}
                                {% endif %}
                            </div>
                        </div>
                        <div>
                            <a href="/blog/{{ blog.id }}" class="btn btn-sm btn-outline-success" target="_blank">æŸ¥çœ‹</a>
                        </div>
                    </div>
                    {% endfor %}
                    
                    {% if not stats.popular_blogs %}
                    <div class="text-center py-3 text-muted">
                        æš‚æ— æ–‡ç« 
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- æ ç›®åˆ†å¸ƒ -->
    <div class="dashboard-card">
        <h5 class="mb-3">ğŸ“Š æ ç›®æ–‡ç« åˆ†å¸ƒ</h5>
        <div class="category-chart">
            {% for category in stats.category_stats %}
            <div class="category-item">
                <div class="category-icon">{{ category.icon }}</div>
                <div class="category-name">{{ category.name }}</div>
                <div class="category-count">{{ category.count }}</div>
            </div>
            {% endfor %}
            
            {% if stats.uncategorized_blogs > 0 %}
            <div class="category-item">
                <div class="category-icon">ğŸ“‹</div>
                <div class="category-name">æœªåˆ†ç±»</div>
                <div class="category-count">{{ stats.uncategorized_blogs }}</div>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- å¿«é€Ÿæ“ä½œ -->
    <div class="dashboard-card">
        <h5 class="mb-3">âš¡ å¿«é€Ÿæ“ä½œ</h5>
        <div class="row">
            <div class="col-md-3 mb-2">
                <a href="/blog/upload_blog" class="btn btn-primary w-100">
                    â• å‘å¸ƒæ–°æ–‡ç« 
                </a>
            </div>
            <div class="col-md-3 mb-2">
                <a href="/blog/admin/categories" class="btn btn-success w-100">
                    ğŸ·ï¸ ç®¡ç†æ ç›®
                </a>
            </div>
            <div class="col-md-3 mb-2">
                <a href="/blog/admin/articles" class="btn btn-info w-100">
                    ğŸ“‚ æ–‡ç« ç®¡ç†
                </a>
            </div>
            <div class="col-md-3 mb-2">
                <a href="/blog/" class="btn btn-outline-secondary w-100">
                    ğŸ‘ï¸ æŸ¥çœ‹åšå®¢
                </a>
            </div>
        </div>
    </div>

    <!-- è¿”å›é“¾æ¥ -->
    <div class="text-center mt-4">
        <a href="/" class="btn btn-outline-primary">ğŸ  è¿”å›é¦–é¡µ</a>
        <a href="/blog/" class="btn btn-outline-secondary">ğŸ“ åšå®¢é¦–é¡µ</a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // ç»Ÿè®¡æ•°å­—åŠ¨ç”»æ•ˆæœ
    function animateNumber(element, target) {
        let current = 0;
        const increment = target / 30;
        const timer = setInterval(() => {
            current += increment;
            if (current >= target) {
                current = target;
                clearInterval(timer);
            }
            element.textContent = Math.floor(current);
        }, 50);
    }

    // ä¸ºæ‰€æœ‰ç»Ÿè®¡æ•°å­—æ·»åŠ åŠ¨ç”»
    document.querySelectorAll('.stat-number').forEach(element => {
        const target = parseInt(element.textContent);
        element.textContent = '0';
        animateNumber(element, target);
    });

    // ä¸ºæ ç›®ç»Ÿè®¡æ•°å­—æ·»åŠ åŠ¨ç”»
    document.querySelectorAll('.category-count').forEach(element => {
        const target = parseInt(element.textContent);
        element.textContent = '0';
        setTimeout(() => {
            animateNumber(element, target);
        }, 500);
    });
});
</script>
{% endblock %}

{% block footer_text %}
åšå®¢ç®¡ç†åå° - ä»…ç®¡ç†å‘˜å¯è®¿é—® | å½“å‰ç‰ˆæœ¬ï¼šv2.0
{% endblock %}
